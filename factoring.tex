\chapter{Factoring polynomials}
\epigraph[author={Tennessee Williams}, source={Baby Doll and Tiger Tail}, etc={Act I, Scene 2}]{\emph{Silva:} You've got many refinements. I don't think you need to worry about your failure at long division.
I mean, after all, you got through short division, and short division is all that a lady ought to cope with.}\SubIndex{Williams, Tennessee}
\section{Factoring with integer coefficients}
\begin{problem}{factoring:prime.outputs}
Suppose that \(p(x)\) is a nonconstant polynomial with integer coefficients.
Prove that there are infinitely many positive integers \(x\) at which \(p(x)\) is not prime.
\end{problem}
\begin{answer}{factoring:prime.outputs}
We can flip the sign to get \(p(x)\) to have a positive leading coefficient.
After \(x\) is made larger than any of the (finitely many) roots of \(p(x)\), we know that \(p(x)>0\).
Pick any integer \(N\) larger than any of the roots of \(p(x)\).
In particular, \(p(N)>0\).
For any integer \(\ell\), if we set \(x=N+\ell p(N)\), then expanding out \(x^k=N^k+\dots\), the \(\dots\) terms all contain a factor of \(p(N)\), so \(p(x)=p(N)+\dots\), where again the \(\dots\) terms all contain a factor of \(p(N)\).
So \(p(x)=0\) modulo \(p(N)\) for all of the infinitely many integers \(x=N+\ell p(N)\).
\end{answer}
\begin{proposition}\label{proposition:F.p.polynomial.factorization}
Working with coefficients remainders modulo a prime, if \(0=b(x)c(x)\) for two polynomials \(b(x), c(x)\), then either \(b(x)=0\) or \(c(x)=0\).
\end{proposition}
\begin{proof}
The highest term of the product is the product of the highest terms, so has coefficient the product of the coefficients of the highest terms.
In problem~\vref{problem:modular.arithmetic:prime.field}, we saw that if a product of remainders modulo a prime vanishes (modulo that prime), then one of the factors is zero.
So the coefficient of the highest term of either \(b(x)\) or of \(c(x)\) is zero.
But then by definition that isn't the highest term.
\end{proof}
\begin{lemma}[Gauss's lemma\define{Gauss's lemma}]
Any polynomial \(p(x)\) with integer coefficients factors over rational numbers just when it factors over integers.
In other words, suppose that we can factor it as \(p(x)=b(x)c(x)\) into polynomials \(b(x)\), \(c(x)\) with rational coefficients.
Then we can rescale each of \(b(x)\) and \(c(x)\), by multiplying by nonzero rational numbers, to arrange that \(p(x)=b(x)c(x)\) still but now \(b(x)\) and \(c(x)\) have integer coefficients.
\end{lemma}
\begin{proof}
The idea is to just clear denominators.
First, take a least common denominator \(d\) for all of the coefficients of \(b(x)\) and \(c(x)\), and scale both sides with it, so that now we have an equation \(d \, p(x)=b(x)c(x)\) with new polynomials \(b(x), c(x)\), but with integer coefficients.
Expand \(d\) into its prime factorization, say
\[
d=p_1 p_2 \dots p_n, 
\]
where some of these primes might appear several times in the factorization.
Quotient out the coefficients of both sides of \(d \, p(x)=b(x)c(x)\) by the prime \(p_1\) to see \(0=\bar{b}(x)\bar{c}(x)\).
So then one of \(\bar{b}(x)\) or \(\bar{c}(x)\) vanishes (in other words, all of its coefficients vanish).
Say, for example, \(\bar{b}(x)=0\).
But then \(p_1\) divides into all coefficients of \(b(x)\), so we can divide both sides of \(d \, p(x)=b(x)c(x)\) by \(p_1\).
Repeat until you have divided away all of the prime factors in \(d\).
\end{proof}
A polynomial with integer coefficients is \emph{irreducible}%
\define{irreducible!polynomial}%
\define{reducible!polynomial}% 
\define{polynomial!irreducible}%
\define{polynomial!reducible}
if it does not split into a product \(b(x)c(x)\) except for having \(b(x)=\pm 1\).
(Note that this notion of irreducibility is different from being irreducible over a field.)
\begin{example}
\[
2x^3-4x+2=(2)(x-1)(x^2+x-1)=(-2)(-x+1)(x^2+x-1)=(-2)(x-1)(-x^2-x+1)
\]
are three different factorizations into irreducibles.
\end{example}
\begin{corollary}\label{corollary:coprime.coeffs}
Suppose that \(p(x)\) is a polynomial with coprime integer coefficients.
Then it is irreducible as an integer coefficient polynomial just when it is irreducible as an rational coefficient polynomial.
\end{corollary}
\begin{proof}
By Gauss' Lemma above, if \(p(x)\) factors into rational polynomials, then it factors into integer polynomials.
Conversely, since \(p(x)\) has coprime coefficients, if \(p(x)\) factors into integer polynomials \(p(x) = b(x)c(x)\) then neither \(b(x)\) nor \(c(x)\) can be constant polynomials. 
\end{proof}
\begin{example}
We saw~\vpageref{example:x.cubed} that \(x^3-3x-1\) has no rational roots.
If it is reducible over the field of rational numbers, then it has a rational root; see problem~\vref{problem:polynomials:factor.quadratic}.
So therefore it is irreducible over the field of rational numbers.
Its coefficients are coprime, so it is irreducible over the integers.
\end{example}
\begin{theorem}
Every nonzero integer coefficient polynomial has a factorization into irreducible integer coefficient polynomials, unique up to the order in which we write down the factors and up to perhaps multiplying factors by \(-1\).
\end{theorem}
\begin{proof}
Let \(d\) be the greatest common divisor of the coefficients of \(p(x)\), so that \(p(x) = d \, P(x)\), where the coefficients of \(P(x)\) are coprime. 
Since \(d\) factors uniquely into primes, it suffices to prove that
\(P(x)\) can be factored uniquely into irreducibles. 
Thus we may assume that coefficients of \(p(x)\) are coprime. 

Factor \(p(x)\) into irreducibles over the field of rational numbers.
By Gauss' Lemma, such a factorization yields a factorization of \(p(x)\) into integer coefficient factors, each a constant rational number multiple of the rational coefficient factors. 
We want to check that the factors remain irreducible.
Since the coefficients of \(p(x)\) are coprime, the coefficients in each of these factors are also coprime: a common divisor would pull out of the whole factorization.
By corollary~\vref{corollary:coprime.coeffs}, each factor is irreducible over the integers.

Suppose that we have two factorizations of \(p(x)\) into irreducible integer coefficient polynomials.
Recall that the factorization over rationals is unique up to reordering factors and scaling factors by nonzero constant rationals.
Therefore our two factorizations are each obtained from the other by such tricks.
So if we take out one of the factors \(P(x)\) from one factorization, and the corresponding factor \(Q(x)\) from the other, then \(Q(x)=\frac{a}{b}P(x)\) where \(a, b\) are integers, so \(bQ(x)=aP(x)\).
The coefficients of \(P(x)\) are coprime integers, and so are those of \(Q(x)\).
Taking greatest common divisor, we find \(b = \pm a\).
So \(P(x)=\pm Q(x)\).
\end{proof}
Sage can test to see if a polynomial is irreducible:
\begin{sageblock}
R.<x> = PolynomialRing(QQ)
b=x^3+x+2
b.is_irreducible()
\end{sageblock}
yields \(\sage{b.is_irreducible()}\).
Indeed \verb!factor(b)! yields \(\sage{factor(b)}\).
To work over the finite field with \(2\) elements:
\begin{sageblock}
R.<x> = PolynomialRing(GF(2))
b=x^3+x+2
b.is_irreducible()
\end{sageblock}
yields \(\sage{b.is_irreducible()}\), while \verb!factor(b)! yields \(\sage{factor(b)}\).

\section{Eisenstein's criterion: checking that there are no more factors}
\begin{proposition}[Eisenstein's criterion]\define{criterion!Eisenstein}\define{Eisenstein's criterion}
Take a polynomial
\[
q(x) = a_n x^n + a_{m-1} x^{m-1} + \dots + a_1 x + a_0
\]
with integer coefficients \(a_0, a_1, \dots, a_n\).
Suppose that there is a prime \(p\) so that
\begin{enumerate}
\item 
\(p\) does not divide the highest degree coefficient \(a_n\) and
\item
\(p\) divides all of the other coefficients and
\item
\(p^2\) does not divide the lowest coefficient \(a_0\).
\end{enumerate}
Then \(q(x)\) is irreducible over the field of rational numbers.
\end{proposition}
\begin{proof}
By corollary~\vref{corollary:coprime.coeffs}, if \(q(x)\) factors over the field of rational numbers, then it factors over the integers, say
\[
a_n x^n + a_{n-1}x^{n-1} 
+\dots+ a_0 
= 
\pr{
b_r x^r + \dots + b_0
}
\pr{
c_s x^s + \dots + c_0
}
\]
with integer coefficients
\[
b_0, b_1, \dots, b_r, c_0, c_1, \dots, c_s.
\]
Since \(p\), but not \(p^2\), divides the lowest coefficient \(a_0 = b_0 c_0\), \(p\) divides exactly one of \(b_0, c_0\), say \(b_0\). 
Now from the equation 
\[
a_1 = b_0 c_1 + b_1 c_0,
\]
and the fact that \(p\) divides all but the highest degree coefficient \(a_n\),
we see that \(p\) divides \(b_1\). 
From the equation
\[
a_2 = b_0 c_2 + b_1 c_1 + b_2 c_0,
\]
we see that \(p\) divides \(b_2\).
By induction, we find that \(p\) divides all coefficients
\[
b_0, b_1, \dots, b_r.
\]
This contradicts the condition that \(p\) does not divide \(a_n\).
\end{proof}
\begin{example}
The polynomial \(x^9+14x+7\) is irreducible by Eisenstein's criterion.
\end{example}
\begin{example}
For any prime \(p\) and positive integer \(d\), the polynomial \(x^d-p\) satisfies Eisenstein's criterion.
Therefore there are no rational number square roots, cube roots, and so on, of any prime number \(p\).
\end{example}
\begin{example}
The polynomial \(x^2+4x+4=(x+2)^2\) is not irreducible, so we \emph{cannot} always apply Eisenstein's criterion with nonprime integers \(p\), for instance with \(p=4\).
\end{example}
\begin{problem}{polynomials:Eisenstein}
Give some examples of polynomials to which Eisenstein's criterion applies.
\end{problem}
\begin{problem}{polynomials:backwards}
Suppose that \(b(x)\) is a polynomial with integer coefficients of degree \(d\).
Prove that \(c(x)\defeq x^db(1/x)\) is also a polynomial with integer coefficients of degree \(d\).
Prove that \(b(x)\) is irreducible just when \(c(x)\) is.
\end{problem}
\begin{problem}{polynomials:Eisenstein.2}
Explain why the lowest terms in \(y\) of a product \(b(x,y)c(x,y)\) are obtained by expanding the product of the lowest \(y\) terms in each of \(b(x,y)\) and \(c(x,y)\).
Use this to prove that
\[
p(x,y)=5+25x+8x^2+7xy+19y^3
\]
is irreducible.
\end{problem}
\begin{problem}{polynomials:Eisenstein.3}
Explain why the highest terms in \(y\) of a product \(b(x,y)c(x,y)\) are obtained by expanding the product of the highest \(y\) terms in each of \(b(x,y)\) and \(c(x,y)\).
Use this to prove that
\[
q(x,y)=2+9xy+40x^3y^2+5y^3+25xy^3+8x^2y^3
\]
is irreducible.
\end{problem}
\begin{problem}{factoring:Eisen.poly.2}
Is 
\[
a(x,y)=y^9x^9+(y^2+1)x^8+(y^2+1)x^7+y+1
\]
irreducible as a polynomial in two variables \(x,y\) with coefficients remainders modulo \(2\)?
\end{problem}
\begin{answer}{factoring:Eisen.poly.2}
Take \(p(y)=y+1\), clearly irreducible since linear and not constant.
Note that \(p(y)^2=y^2+1\).
So Eisenstein applies: \(a(x,y)\) is irreducible.
\end{answer}
\begin{problem}{polynomials:Eisenstein.cyclotomic}
Suppose that \(p\) is a prime number.
Prove that the polynomial \(c(x)\defeq x^{p-1}+x^{p-2}+\dots+x+1\) is irreducible.
Hint: problem~\vref{problem:induction:cyclotomic}.
\end{problem}
\begin{answer}{polynomials:Eisenstein.cyclotomic}
By problem~\vref{problem:induction:cyclotomic}, 
\begin{align*}
c(x+1)
&=\binom{p}{1}+\binom{p}{2}x+\binom{p}{3}x^2+\dots+\binom{p}{p-1}x^{p-2}+\binom{p}{p}x^{p-1},
\\
&=p+\frac{p!}{2!(p-2)!}x+\frac{p!}{3!(p-3)!}x^2+\dots+\frac{p!}{(p-1)!1!}x^{p-2}+x^{p-1}.
\end{align*}
Clearly there is a factor of \(p\) in each term, and no \(p^2\) factor in the constant term.
\end{answer}

\section{Eisenstein's criterion in sage}
To check Eisenstein's criterion, tell sage to work with integer coefficient polynomials:
\begin{sageblock}
R.<x> = PolynomialRing(ZZ)
\end{sageblock}
Write a function to find a list of prime factors of any integer:
\begin{sageblock}
def prime_factors(x):
    x=abs(x)
    list=[]
    p=2
    while p<=x:
        if x%p==0:
            list=list+[p]
            while x%p==0:
                x=x//p
        p=p+1
    return list
\end{sageblock}
Note that \verb![]! represents an empty list, and we add lists by concatenating them.
So \verb!prime_factors(-6)! yields \verb![2,3]!, the prime factors in order.
Finally, we make a function \verb!Eisenstein(b)! to apply to integer coefficient polynomials, which returns the lowest prime \(p\) for which Eisenstein's criterion applies to our polynomial \(b(x)\), or returns \(0\) if no such prime exists.
\begin{sageblock}
def Eisenstein(b):
    c=b.coefficients()
    highest=c.pop()
    possible_primes=prime_factors(gcd(c))
    for p in possible_primes:
        if (highest%p!=0) and (c[0]%(p^2)!=0):
            return p
    return 0
\end{sageblock}
For example
\begin{sageblock}
Eisenstein(2*x^8+27*x^4+3*x^2+6)
\end{sageblock}
yields \(\sage{Eisenstein(2*x^8+27*x^4+3*x^2+6)}\).
The expression \verb!c=b.coefficients()! yields a list of coefficients of the polynomial, in order from lowest to highest degree.
The expression \verb!c.pop()! returns the last element in the list, and at the same time deletes that element from the list.
If \verb!Eisenstein(p)! is not \verb![]!, then \verb!p! is irreducible by Eisenstein's criterion.

\section{Factorization over rational functions and over polynomials}
\begin{problem}{factoring:circle}
Over the
\begin{enumerate}
\item
complex numbers,
\item
real numbers,
\item
rational numbers or
\item
integers,
\item
integer remainders modulo \(2\),
\item
integer remainders modulo \(3\),
\end{enumerate}
is
\[
b(x,y)=x^2+y^2
\]
reducible as a polynomial in two variables \(x,y\)?
\end{problem}
\begin{answer}{factoring:circle}
Over the complex numbers,
\[
b(x,y)=(x+iy)(x-iy).
\]
Over all of the other fields, if reducible, it splits into linear factors
\[
b(x,y)=(\alpha x+\beta y)(\gamma x+\delta y)=\alpha\gamma x^2 + (\alpha\delta+\beta\gamma)xy+\beta\delta y.
\]
None of the coefficients can vanish, since \(b(x,y)\) doesn't have a factor of \(x\) or \(y\).
For real coefficients, \(b(x,y)\) vanishes along a line \(\alpha x+\beta y=0\).
This is not possible because squares \(x^2,y^2\) can't be negative, so if \(x^2+y^2=0\) then \(x=y=0\).
Alternate proof: plug in \(y=1\) to get \(x^2+1=(\alpha x+\beta)(\gamma x+\delta\), vanishing at \(x=-\beta/\alpha\), a square root of \(-1\).
It follows that \(b(x,y)\) is irreducible over the rationals, because rationals are real.
The coefficients of \(b(x,y)\) are coprime, so \(b(x,y)\) is irreducible over the integers.
\end{answer}
\begin{proposition}[Gauss' lemma]\label{proposition:Gauss.lemma}
Suppose that \(p(x,y)\) is a polynomial in two variables over a field, and that \(p(x,y)\) factors as \(p(x,y)=b(x,y)c(x,y)\), where \(b(x,y)\) and \(c(x,y)\) are polynomial in \(x\) with coefficients rational functions of \(y\).
Then \(p(x,y)\) also factors in polynomials in \(x,y\).
To be precise, after perhaps multiplying \(b(x,y)\) by a rational function of \(y\), and \(c(x,y)\) by its reciprocal, we can arrange that \(b(x,y)\) and \(c(x,y)\) are polynomials in both \(x\) and \(y\).
\end{proposition}
\begin{proof}
The coefficients in \(x\) on the right hand side of the equation
\(p(x,y) = b(x,y)c(x,y)\) are rational in \(y\), hence are quotients of polynomials in \(y\). Multiplying through by a common denominator we obtain an equation 
\[
d(y)p(x,y) = b(x,y)c(x,y)
\]
with new \(b(x,y), c(x,y)\) which are polynomials in \(x,y\), and \(d(y)\) is a nonzero polynomial. 
If \(d(y)\) is constant, divide it into \(c(x,y)\), and the result is proven.

So we can assume that \(d(y)\) is nonconstant and write \(d(y)\) as a product of irreducible polynomials
\[
d(y) = d_1(y)d_2(y) \dots d_n(y).
\]
Expand out \(b(x,y)\) and \(c(x,y)\) into powers of \(x\):
\begin{align*}
b(x,y) &= \sum b_j(y)x^j, \\
c(x,y) &= \sum c_j(y)x^j.
\end{align*}
Then \(d_1(y)\) divides into all of the terms in 
\[
b(x,y)c(x,y)= \sum_n \sum_{j,k} b_j(y)c_k(y) x^{j+k}.
\]
In particular, \(d_1(y)\) divides into the lowest term \(b_0(y)c_0(y)\), so into one of the factors, say into \(b_0(y)\).
Suppose that \(d_1(y)\) divides into all of the terms \(b_0(y), b_1(y), \dots, b_{j-1}(y)\), and also all of the terms \(c_0(y), c_1(y), \dots, c_{k-1}(y)\).
The \(x^{j+k}\) term has coefficient
\begin{align*}
& \underline{b_0(y)} c_{j+k}(y) + \underline{b_1(y)} c_{j+k-1}(y) + \dots + \underline{b_{j-1}(y)} c_{k+1}(y) \\
& \qquad + b_j(y) c_k(y) + b_{j+1}(y) \underline{c_{k-1}(y)} + \dots + b_{j+k}(y) \underline{c_0(y)}.
\end{align*}
So \(d_1(y)\) divides into the underlined expressions, and must divide into one of \(b_j(y)\) or \(c_k(y)\).
So we can increase the value of \(j\), or the value of \(k\), or both.
By induction on both \(j\) and \(k\), \(d_1(y)\) divides into all terms in \(b(x,y)\) (and hence divides into \(b(x,y)\)), or divides into all terms in \(c(x,y)\) (and hence divides into \(c(x,y)\)).
We cancel out a copy of \(d_1(y)\) from both sides of the equation
\[
d(y)p(x,y) = b(x,y)c(x,y)
\]
and proceed by induction on the degree of \(d(y)\).
\end{proof}
\begin{proposition}[Eisenstein's criterion]\define{criterion!Eisenstein}\define{Eisenstein's criterion}
Take a polynomial \(q(x,y)\) over a field.
Expand in powers of \(x\):
\[
q(x,y) = a_n(y) x^n + a_{n-1}(y) x^{n-1} + \dots + a_1(y) x + a_0(y),
\]
so that each \(a_0(y),a_1(y),\dots,a_n(y)\) is a polynomial.
Suppose that there is an irreducible polynomial \(p(y)\) so that
\begin{enumerate}
\item 
\(p(y)\) does not divide the highest degree term \(a_n(y)\) and
\item
\(p(y)\) divides all of the other terms \(a_0(y),\dots,a_{n-1}(y)\) and
\item
\(p(y)^2\) does not divide the lowest coefficient \(a_0(y)\).
\end{enumerate}
Then \(q(x,y)\) is irreducible.
\end{proposition}
The proof is identical to the previous proof of Eisenstein's criterion.
\begin{example}
\(x^{13}+xy+y\) is irreducible, as it has a factor of \(y\) in each term in \(x\), except the highest term.
\end{example}
\begin{problem}{factoring:Eisen.poly.xy}
Is
\[
q(x)=10000x^{10000}+999x^{999}+333x^{333}+111
\]
irreducible over the rational numbers?
\end{problem}
\begin{answer}{factoring:Eisen.poly.xy}
Eisenstein with \(p=3\), \(111=(3)(37)\), and \(37\) is not divisible by 3, so \(q(x)\) is irreducible.
\end{answer}
\begin{problem}{factoring:Eisen.poly.xy.mod.2}
Is
\[
b(x,y)=(y+1)x^{10000}+(y^2+y+1)^{999}x^{999}+(y^2+y+1)^{333}x^{333}+y^2+y+1
\]
irreducible as a polynomial in two variables \(x,y\) with coefficients 
\begin{enumerate}
\item remainders modulo \(2\)?  
\item integers?
\end{enumerate}
\end{problem}
\begin{answer}{factoring:Eisen.poly.xy}
This \(b(x,y)\) is irreducible, by Eisenstein's criterion, with with \(p(y)=y^2+y+1\).
We need to know that \(p(y)\) is irreducible, and to see this: any reducible quadratic, having degree 2, splits into irreducibles of degrees 1 each, so linear.
The only linear polynomials are the two linears \(y,y+1\).
Their 3 possible products are \(y^2,y(y+1),(y+1)^2=y^2+1\), not equal to \(y^2+y+1\).
So irreducible over remainders modulo \(2\).
If it reduces over integers, quotient by \(2\) to get a reduction in remainders modulo \(2\), or to get zero.
But it remains nonzero and irreducible.
\end{answer}
\begin{problem}{factoring:CRT.poly}
State and prove a Chinese remainder theorem for polynomials of one variable over any field.
Apply it to find the smallest degree polynomial \(p(x)\) so that, over the integer remainders modulo \(2\),
\begin{alignat*}{2}
p(x) &= x+1 &\pmod{x^2+x+1}, \\
p(x) &= x   &\pmod{x^3+x+1}.
\end{alignat*}
\end{problem}
\section{Homogeneous polynomials}
The \emph{degree} of a term in a multivariable polynomial is the sum of the degrees in each of the variables; the \emph{degree}\define{degree} of the polynomial is the highest degree of any nonzero term.
A polynomial is \emph{homogeneous}\define{homogeneous!polynomial}\define{polynomial!homogeneous} if all of its terms have the same degree.
\begin{problem}{permuting:homog.test}
Prove that a polynomial \(b(x)\) of degree \(m\) in some variables \(x_1,x_2,\dots,x_n\) over an infinite field is homogeneous just when \(b(tx)=t^mb(x)\) for every \(t\).
Give a counterexample over a finite field.
\end{problem}
\begin{lemma}
Over any field, every factor of a homogeneous polynomial is homogeneous.
\end{lemma}
\begin{proof}
Write the polynomial factorized, as
\(
b(x)c(x)
\).
The highest degree term in \(b(x)\) multiplies by the highest degree term in \(c(x)\) to give the highest degree term in \(b(x)c(x)\), and the same for the lowest degree terms.
Since all terms in \(b(x)c(x)\) have the same degree, so do all terms in \(b(x)\) and in \(c(x)\).
\end{proof}

